---
title: "trivy-image-scan"
description: "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
mode: "wide"
---

import { ToolDetails } from '/snippets/ToolDetails.mdx';

<ToolDetails
  id="b3d0c6fd-609f-4476-81cc-2db6597dee05"
  name="trivy-image-scan"
  description="Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  category="Containers"
  author="trickest-mhmdiaa"
  created_date="2022-04-28"
  container="quay.io/trickest/trivy-image-scan:v0.34.0-patch-3"
  source_url="https://github.com/aquasecurity/trivy"
  license="Unknown"
  output_command=">"
  output_type=""
  iframe_url="https://editor.staging.trickest.io/preview?workflow_url=https://trickest-public-workflow.s3.eu-central-1.amazonaws.com/b3d0c6fd-609f-4476-81cc-2db6597dee05.json"
  inputs={ {
  "debug": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--debug",
    "visible": false,
    "description": "debug mode",
  },
  "quiet": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--quiet",
    "visible": false,
    "description": "suppress progress bar and log output",
  },
  "reset": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--reset",
    "visible": false,
    "description": "remove all caches and database",
  },
  "token": {
    "type": "STRING",
    "order": 2,
    "command": "--token",
    "visible": false,
    "description": "for authentication in client/server mode",
  },
  "trace": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--trace",
    "visible": false,
    "description": "enable more verbose trace output for custom queries",
  },
  "config": {
    "type": "FILE",
    "order": 2,
    "command": "--config",
    "visible": false,
    "description": "config path (default trivy.yaml)",
  },
  "format": {
    "type": "STRING",
    "order": 2,
    "command": "--format",
    "visible": false,
    "description": "format (table, json, sarif, template, cyclonedx, spdx, spdx-json, github, cosign-vuln) (default table)",
  },
  "server": {
    "type": "STRING",
    "order": 2,
    "command": "--server",
    "visible": false,
    "description": "server address in client mode",
  },
  "tf-vars": {
    "type": "STRING",
    "order": 2,
    "command": "--tf-vars",
    "visible": false,
    "description": "specify paths to override the Terraform tfvars files",
  },
  "timeout": {
    "type": "STRING",
    "order": 2,
    "command": "--timeout",
    "visible": false,
    "description": "timeout (default: 5m0s)",
  },
  "helm-set": {
    "type": "STRING",
    "order": 2,
    "command": "--helm-set",
    "visible": false,
    "description": "specify Helm values (can separate values with commas: key1=val1,key2=val2)",
  },
  "insecure": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--insecure",
    "visible": false,
    "description": "allow insecure server connections when using TLS",
  },
  "platform": {
    "type": "STRING",
    "order": 2,
    "command": "--platform",
    "visible": false,
    "description": "set platform in the form os/arch if image is multi-platform capable",
  },
  "redis-ca": {
    "type": "FILE",
    "order": 2,
    "command": "--redis-ca",
    "visible": false,
    "description": "redis ca file location, if using redis as cache backend",
  },
  "severity": {
    "type": "STRING",
    "order": 2,
    "command": "--severity",
    "visible": false,
    "description": "severities of vulnerabilities to be displayed (comma separated) (default: UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL)",
  },
  "template": {
    "type": "FILE",
    "order": 2,
    "command": "--template",
    "visible": false,
    "description": "output template",
  },
  "cache-ttl": {
    "type": "STRING",
    "order": 2,
    "command": "--cache-ttl",
    "visible": false,
    "description": "cache TTL when using redis as cache backend",
  },
  "exit-code": {
    "type": "STRING",
    "order": 2,
    "command": "--exit-code",
    "visible": false,
    "description": "Exit code when vulnerabilities are found",
  },
  "redis-key": {
    "type": "FILE",
    "order": 2,
    "command": "--redis-key",
    "visible": false,
    "description": "redis key file location, if using redis as cache backend",
  },
  "rekor-url": {
    "type": "STRING",
    "order": 2,
    "command": "--rekor-url",
    "visible": false,
    "description": "[EXPERIMENTAL] address of rekor STL server (default https://rekor.sigstore.dev)",
  },
  "skip-dirs": {
    "type": "STRING",
    "order": 2,
    "command": "--skip-dirs",
    "visible": false,
    "description": "specify the directories where the traversal is skipped",
  },
  "vuln-type": {
    "type": "STRING",
    "order": 2,
    "command": "--vuln-type",
    "visible": false,
    "description": "comma-separated list of vulnerability types (os,library)",
  },
  "compliance": {
    "type": "STRING",
    "order": 2,
    "command": "--compliance",
    "visible": false,
    "description": "comma-separated list of what compliance reports to generate (nsa)",
  },
  "ignorefile": {
    "type": "FILE",
    "order": 2,
    "command": "--ignorefile",
    "visible": false,
    "description": "specify .trivyignore file (default .trivyignore)",
  },
  "image-list": {
    "type": "FILE",
    "order": 0,
    "command": "",
    "visible": true,
    "description": "List of images line by line to be scanned",
  },
  "redis-cert": {
    "type": "FILE",
    "order": 2,
    "command": "--redis-cert",
    "visible": false,
    "description": "redis certificate file location, if using redis as cache backend",
  },
  "skip-files": {
    "type": "STRING",
    "order": 2,
    "command": "--skip-files",
    "visible": false,
    "description": "specify the file paths to skip traversal",
  },
  "clear-cache": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--clear-cache",
    "visible": false,
    "description": "clear image caches without scanning",
  },
  "config-data": {
    "type": "FOLDER",
    "order": 2,
    "command": "--config-data",
    "visible": false,
    "description": "specify paths from which data for the Rego policies will be recursively loaded",
  },
  "helm-values": {
    "type": "FILE",
    "order": 2,
    "command": "--helm-values",
    "visible": false,
    "description": "specify paths to override the Helm values.yaml files",
  },
  "license-full": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--license-full",
    "visible": false,
    "description": "eagerly look for licenses in source code headers and license files",
  },
  "offline-scan": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--offline-scan",
    "visible": false,
    "description": "do not issue API requests to identify dependencies",
  },
  "removed-pkgs": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--removed-pkgs",
    "visible": false,
    "description": "detect vulnerabilities of removed packages (only for Alpine)",
  },
  "sbom-sources": {
    "type": "STRING",
    "order": 2,
    "command": "--sbom-sources",
    "visible": false,
    "description": "[EXPERIMENTAL] try to retrieve SBOM from the specified sources (rekor)",
  },
  "token-header": {
    "type": "STRING",
    "order": 2,
    "command": "--token-header",
    "visible": false,
    "description": "specify a header name for token in client/server mode (default Trivy-Token)",
  },
  "cache-backend": {
    "type": "STRING",
    "order": 2,
    "command": "--cache-backend",
    "visible": false,
    "description": "cache backend (e.g. redis://localhost:6379) (default fs)",
  },
  "config-policy": {
    "type": "FOLDER",
    "order": 2,
    "command": "--config-policy",
    "visible": false,
    "description": "specify paths to the Rego policy files directory, applying config files",
  },
  "db-repository": {
    "type": "STRING",
    "order": 2,
    "command": "--db-repository",
    "visible": false,
    "description": "OCI repository to retrieve trivy-db from (default ghcr.io/aquasecurity/trivy-db)",
  },
  "file-patterns": {
    "type": "FILE",
    "order": 2,
    "command": "--file-patterns",
    "visible": false,
    "description": "specify config file patterns",
  },
  "ignore-policy": {
    "type": "FILE",
    "order": 2,
    "command": "--ignore-policy",
    "visible": false,
    "description": "specify the Rego file to evaluate each vulnerability",
  },
  "list-all-pkgs": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--list-all-pkgs",
    "visible": false,
    "description": "enabling the option will output all packages regardless of vulnerability",
  },
  "secret-config": {
    "type": "FILE",
    "order": 2,
    "command": "--secret-config",
    "visible": false,
    "description": "specify a path to config file for secret scanning (default trivy-secret.yaml)",
  },
  "show-progress": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--no-progress",
    "visible": false,
    "description": "suppress progress bar",
  },
  "custom-headers": {
    "type": "STRING",
    "order": 2,
    "command": "--custom-headers",
    "visible": false,
    "description": "custom headers in client mode",
  },
  "ignore-unfixed": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--ignore-unfixed",
    "visible": false,
    "description": "display only fixed vulnerabilities",
  },
  "skip-db-update": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--skip-db-update",
    "visible": false,
    "description": "skip updating vulnerability database",
  },
  "dependency-tree": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--dependency-tree",
    "visible": false,
    "description": "[EXPERIMENTAL] show dependency origin tree of vulnerable packages",
  },
  "helm-set-string": {
    "type": "STRING",
    "order": 2,
    "command": "--helm-set-string",
    "visible": false,
    "description": "specify Helm string values on the command line (can specify multiple or separate values with commas: key1=val1,key2=val2)",
  },
  "security-checks": {
    "type": "STRING",
    "order": 2,
    "command": "--security-checks",
    "visible": false,
    "description": "comma-separated list of what security issues to detect (vuln,config,secret,license) (default [vuln,secret])",
  },
  "download-db-only": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--download-db-only",
    "visible": false,
    "description": "download/update vulnerability database but don't run a scan",
  },
  "ignored-licenses": {
    "type": "STRING",
    "order": 2,
    "command": "--ignored-licenses",
    "visible": false,
    "description": "specify a list of license to ignore",
  },
  "policy-namespaces": {
    "type": "STRING",
    "order": 2,
    "command": "--policy-namespaces",
    "visible": false,
    "description": "Rego namespaces",
  },
  "username-password": {
    "type": "FILE",
    "order": 1,
    "command": "",
    "visible": true,
    "description": "Username and password for Docker Hub registry (format username:password)",
  },
  "include-non-failures": {
    "type": "BOOLEAN",
    "order": 2,
    "command": "--include-non-failures",
    "visible": false,
    "description": "include successes and exceptions, available with '--security-checks config'",
  },
}}
/>